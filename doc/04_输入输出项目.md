 # 输入输出项目

本文档定义了保险会计系统中的输入输出数据项，包括文件区变量、工作存储区变量和联机区变量。

## 文件区变量

### 机能ID：INSPMUPD

| 项目编号 | 物理名称 | 逻辑名称 | 数据类型 | 初始值 | 必须 | 备注 |
|----------|----------|----------|---------|-------|------|------|
| 1 | PAYMENT-RECORD-IN | 支付记录输入 | X(58) | 无 | 是 | 输入文件记录 |
| 2 | REPORT-LINE | 报告行 | X(132) | 无 | 是 | 输出报告记录 |

### 机能ID：INSPMLOG_EN

| 项目编号 | 物理名称 | 逻辑名称 | 数据类型 | 初始值 | 必须 | 备注 |
|----------|----------|----------|---------|-------|------|------|
| 3 | LOG-RECORD | 日志记录 | X(200) | 无 | 是 | 日志文件记录 |

## 工作存储区变量

### 机能ID：INSPMUPD

| 项目编号 | 物理名称 | 逻辑名称 | 数据类型 | 初始值 | 必须 | 备注 |
|----------|----------|----------|---------|-------|------|------|
| 4 | WS-FILE-STATUS | 文件状态 | XX | SPACES | 是 | 文件操作状态 |
| 5 | WS-EOF-FLAG | 文件结束标志 | X | 'N' | 是 | 文件读取结束标志 |
| 6 | WS-READ-COUNT | 读取计数 | 9(5) | ZEROS | 是 | 读取记录计数 |
| 7 | WS-PROCESS-COUNT | 处理计数 | 9(5) | ZEROS | 是 | 处理记录计数 |
| 8 | WS-ERROR-COUNT | 错误计数 | 9(5) | ZEROS | 是 | 错误记录计数 |
| 9 | WS-CURRENT-DATE-DATA | 当前日期时间数据 | 复合结构 | 无 | 是 | 保存当前日期时间 |
| 10 | WS-ACCOUNTING-PERIOD | 会计期间 | X(6) | 无 | 是 | 当前会计期间(YYYYMM) |
| 11 | HL-HEADING-LINE-1 | 标题行1 | 复合结构 | 无 | 是 | 报表标题行1 |
| 12 | HL-HEADING-LINE-2 | 标题行2 | 复合结构 | 无 | 是 | 报表标题行2 |
| 13 | HL-HEADING-LINE-3 | 标题行3 | 复合结构 | 无 | 是 | 报表标题行3 |
| 14 | DL-DETAIL-LINE | 明细行 | 复合结构 | 无 | 是 | 报表明细行 |
| 15 | TL-TOTAL-LINE | 汇总行 | 复合结构 | 无 | 是 | 报表汇总行 |

#### 支付记录结构

| 项目编号 | 物理名称 | 逻辑名称 | 数据类型 | 初始值 | 必须 | 备注 |
|----------|----------|----------|---------|-------|------|------|
| 16 | PR-POLICY-ID | 保单ID | X(10) | 无 | 是 | 保单标识符 |
| 17 | PR-PAYMENT-DATE | 支付日期 | X(8) | 无 | 是 | 支付日期(YYYYMMDD) |
| 18 | PR-PAYMENT-METHOD | 支付方式 | X(2) | 无 | 是 | 支付方式代码 |
| 19 | PR-AMOUNT | 支付金额 | 9(8)V99 | 无 | 是 | 保费金额 |
| 20 | PR-PAYMENT-ID | 支付ID | X(12) | 无 | 是 | 支付记录标识符 |
| 21 | PR-REFERENCE-NO | 参考编号 | X(16) | 无 | 否 | 支付参考编号 |

#### SQL通信区域

| 项目编号 | 物理名称 | 逻辑名称 | 数据类型 | 初始值 | 必须 | 备注 |
|----------|----------|----------|---------|-------|------|------|
| 22 | SQLCA | SQL通信区域 | 复合结构 | 无 | 是 | SQL操作通信区域 |
| 23 | SQLCODE | SQL返回代码 | S9(9) COMP | 无 | 是 | SQL操作返回代码 |

#### 日期计算参数

| 项目编号 | 物理名称 | 逻辑名称 | 数据类型 | 初始值 | 必须 | 备注 |
|----------|----------|----------|---------|-------|------|------|
| 24 | DATE-CALC-PARAMS | 日期计算参数 | 复合结构 | 无 | 是 | 日期计算参数结构 |
| 25 | DC-FUNCTION-CODE | 功能代码 | X | 无 | 是 | 日期计算功能代码 |
| 26 | DC-BASE-DATE | 基准日期 | X(8) | 无 | 是 | 基准日期(YYYYMMDD) |
| 27 | DC-TARGET-DATE | 目标日期 | X(8) | 无 | 是 | 目标日期(YYYYMMDD) |
| 28 | DC-DAYS | 天数 | S9(5) COMP-3 | 无 | 是 | 计算的天数 |
| 29 | DC-RETURN-CODE | 返回代码 | X | 无 | 是 | 日期计算返回代码 |

#### 日志参数

| 项目编号 | 物理名称 | 逻辑名称 | 数据类型 | 初始值 | 必须 | 备注 |
|----------|----------|----------|---------|-------|------|------|
| 30 | LOG-PARAMS | 日志参数 | 复合结构 | 无 | 是 | 日志参数结构 |
| 31 | LOG-LEVEL | 日志级别 | X | 无 | 是 | 日志级别(I/W/E/D) |
| 32 | LOG-MODULE | 模块名 | X(8) | 无 | 是 | 记录日志的模块名 |
| 33 | LOG-MESSAGE | 日志消息 | X(100) | 无 | 是 | 日志消息内容 |
| 34 | LOG-RETURN-CODE | 返回代码 | X | 无 | 是 | 日志操作返回代码 |

### 机能ID：INSPOLVD

| 项目编号 | 物理名称 | 逻辑名称 | 数据类型 | 初始值 | 必须 | 备注 |
|----------|----------|----------|---------|-------|------|------|
| 35 | SQLCA | SQL通信区域 | 复合结构 | 无 | 是 | SQL操作通信区域 |
| 36 | WS-POLICY-COUNT | 保单计数 | S9(4) COMP | 无 | 是 | 查询到的保单数量 |

### 机能ID：INSPMINS

| 项目编号 | 物理名称 | 逻辑名称 | 数据类型 | 初始值 | 必须 | 备注 |
|----------|----------|----------|---------|-------|------|------|
| 37 | SQLCA | SQL通信区域 | 复合结构 | 无 | 是 | SQL操作通信区域 |
| 38 | WS-CURRENT-DATE-DATA | 当前日期时间数据 | 复合结构 | 无 | 是 | 保存当前日期时间 |
| 39 | WS-TIMESTAMP | 时间戳 | X(14) | 无 | 是 | 格式化时间戳 |

### 机能ID：INSPMLOG_EN

| 项目编号 | 物理名称 | 逻辑名称 | 数据类型 | 初始值 | 必须 | 备注 |
|----------|----------|----------|---------|-------|------|------|
| 40 | WS-CURRENT-DATE-DATA | 当前日期时间数据 | 复合结构 | 无 | 是 | 保存当前日期时间 |
| 41 | WS-TIMESTAMP | 时间戳 | X(19) | 无 | 是 | 格式化时间戳 |
| 42 | WS-LOG-LINE | 日志行 | X(200) | 无 | 是 | 格式化日志行 |
| 43 | WS-FILE-OPENED | 文件已打开标志 | X | 'N' | 是 | 日志文件打开状态 |
| 44 | WS-FILE-STATUS | 文件状态 | XX | SPACES | 是 | 文件操作状态 |

## 联机区变量

### 机能ID：INSPOLVD

| 项目编号 | 物理名称 | 逻辑名称 | 数据类型 | 初始值 | 必须 | 备注 |
|----------|----------|----------|---------|-------|------|------|
| 45 | LS-POLICY-ID | 保单ID | X(10) | 无 | 是 | 输入参数：保单ID |
| 46 | LS-SQLCODE | SQL返回代码 | S9(9) COMP | 无 | 是 | 输出参数：SQL操作返回代码 |

### 机能ID：INSPMINS

| 项目编号 | 物理名称 | 逻辑名称 | 数据类型 | 初始值 | 必须 | 备注 |
|----------|----------|----------|---------|-------|------|------|
| 47 | PAYMENT-RECORD | 支付记录 | 复合结构 | 无 | 是 | 输入参数：支付记录结构 |
| 48 | LS-ACCOUNTING-PERIOD | 会计期间 | X(6) | 无 | 是 | 输入参数：会计期间 |
| 49 | LS-SQLCODE | SQL返回代码 | S9(9) COMP | 无 | 是 | 输出参数：SQL操作返回代码 |

### 机能ID：INSPMLOG_EN

| 项目编号 | 物理名称 | 逻辑名称 | 数据类型 | 初始值 | 必须 | 备注 |
|----------|----------|----------|---------|-------|------|------|
| 50 | LOG-PARAMS | 日志参数 | 复合结构 | 无 | 是 | 输入参数：日志参数结构 |

## 详细数据结构

### 支付记录结构 (PAYMENT-RECORD)
```
01 PAYMENT-RECORD.
   05 PR-POLICY-ID            PIC X(10).    // 保单ID
   05 PR-PAYMENT-DATE         PIC X(8).     // 支付日期(YYYYMMDD)
   05 PR-PAYMENT-METHOD       PIC X(2).     // 支付方式代码
   05 PR-AMOUNT               PIC 9(8)V99.  // 支付金额
   05 PR-PAYMENT-ID           PIC X(12).    // 支付记录ID
   05 PR-REFERENCE-NO         PIC X(16).    // 参考编号
```

### 日志参数结构 (LOG-PARAMS)
```
01 LOG-PARAMS.
   05 LOG-LEVEL              PIC X.        // 日志级别
      88 LOG-INFO            VALUE 'I'.    // 信息
      88 LOG-WARNING         VALUE 'W'.    // 警告
      88 LOG-ERROR           VALUE 'E'.    // 错误
      88 LOG-DEBUG           VALUE 'D'.    // 调试
   05 LOG-MODULE             PIC X(8).     // 模块名
   05 LOG-MESSAGE            PIC X(100).   // 日志消息
   05 LOG-RETURN-CODE        PIC X.        // 返回代码
      88 LOG-SUCCESS         VALUE '0'.    // 成功
      88 LOG-FAILURE         VALUE '9'.    // 失败
```

### 日期计算参数结构 (DATE-CALC-PARAMS)
```
01 DATE-CALC-PARAMS.
   05 DC-FUNCTION-CODE       PIC X.        // 功能代码
      88 DC-ADD-DAYS         VALUE 'A'.    // 加天数
      88 DC-SUB-DAYS         VALUE 'S'.    // 减天数
      88 DC-DIFF-DAYS        VALUE 'D'.    // 计算日期差
      88 DC-CHECK-DATE       VALUE 'C'.    // 检查日期有效性
   05 DC-BASE-DATE           PIC X(8).     // 基准日期
   05 DC-TARGET-DATE         PIC X(8).     // 目标日期
   05 DC-DAYS                PIC S9(5) COMP-3.  // 天数
   05 DC-RETURN-CODE         PIC X.        // 返回代码
      88 DC-SUCCESS          VALUE '0'.    // 成功
      88 DC-ERROR            VALUE '9'.    // 错误
```

### SQL通信区域结构 (SQLCA)
```
01  SQLCA.
    05  SQLCAID                PIC X(8).    // 标识符
    05  SQLCABC                PIC S9(9) COMP.  // 通信区长度
    05  SQLCODE                PIC S9(9) COMP.  // 返回代码
    05  SQLERRM.                            // 错误消息
        49  SQLERRML           PIC S9(4) COMP.  // 错误消息长度
        49  SQLERRMC           PIC X(70).       // 错误消息内容
    05  SQLERRP                PIC X(8).    // 错误程序
    05  SQLERRD OCCURS 6 TIMES PIC S9(9) COMP.  // 错误详细信息
    05  SQLWARN.                            // 警告标志
        10 SQLWARN0            PIC X.       // 主警告标志
        10 SQLWARN1            PIC X.       // 字符串截断
        10 SQLWARN2            PIC X.       // NULL终止
        10 SQLWARN3            PIC X.       // 列数不匹配
        10 SQLWARN4            PIC X.       // UPDATE/DELETE WITHOUT WHERE
        10 SQLWARN5            PIC X.       // SQL标准不匹配
        10 SQLWARN6            PIC X.       // 日期/时间计算错误
        10 SQLWARN7            PIC X.       // 保留
    05  SQLEXT                 PIC X(8).    // 扩展
```